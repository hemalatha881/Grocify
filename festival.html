<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Festival Grocery Planner</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { font-family:'Segoe UI',sans-serif; margin:0; background:#f5f5f5; }
.header { position: fixed; top:0; left:0; right:0; z-index:1000; background: #28a745; color:white; padding:15px; display:flex; justify-content:space-between; align-items:center; }
.header h5 { margin:0; }
.main { padding-top:90px; }
.festival-bg { width:100%; height:250px; background-size:cover; background-position:center; border-radius:10px; margin-bottom:20px; transition:0.5s; }
.item-cards { display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:15px; }
.item-card { background:white; border-radius:12px; padding:15px; text-align:center; box-shadow:0 4px 12px rgba(0,0,0,0.2); transition:0.3s; }
.item-card:hover { transform:scale(1.05); }
.modal-content { border-radius:15px; }
#addedItems { margin-top:30px; }
button.festival-btn { margin-right:10px; margin-bottom:10px; }
</style>
</head>
<body>

<div class="header">
  <h5>Festival Grocery Planner</h5>
  <div>
    <button class="btn btn-light btn-sm me-2" onclick="window.location.href='index.html'">üè† Home</button>
  </div>
</div>

<div class="main container">
  <!-- Festival Buttons -->
  <div class="mb-3 d-flex flex-wrap" id="festivalButtons"></div>

  <!-- Festival Image -->
  <div id="festivalBackground" class="festival-bg"></div>

  <!-- Item Cards -->
  <div id="festivalOutput" class="item-cards"></div>

  <!-- Added Items -->
  <h5 class="mt-4">Added Items</h5>
  <ul class="list-group" id="addedItems">
    <li class="list-group-item">No items added yet.</li>
  </ul>
</div>

<!-- Modal -->
<div class="modal" id="popupCard" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content p-3">
      <h5 id="popupItem" class="mb-3 text-center"></h5>
      <label>Quantity:</label>
      <input type="number" id="popupQtyValue" min="1" class="form-control mb-2">
      <select id="popupQtyUnit" class="form-select mb-2">
        <option value="kg">kg</option>
        <option value="grams">grams</option>
        <option value="litres">litres</option>
        <option value="ml">ml</option>
        <option value="packets">packets</option>
        <option value="pieces">pieces</option>
      </select>
      <label>Price (‚Çπ):</label>
      <input type="number" id="popupPrice" min="1" class="form-control mb-2">
      <label>Date:</label>
      <input type="date" id="popupDate" class="form-control mb-3">
      <button class="btn btn-success w-100" onclick="confirmAdd()">Add Item</button>
    </div>
  </div>
</div>

<script>
const apiUrl = "http://localhost:8080/api/grocery";

const festivalData = {
  "Diwali": { 
    bg:"https://www.culturalchronicles.com/wp-content/uploads/2024/07/compress_diwali_2022_reasons.webp",
    items:["Besan","Ghee","Sugar","Flour","Cashews","Almonds","Raisins","Oil","Cardamom","Milk","Dry Fruits","Kaju Katli","Chocolates","Coconut","Paneer","Butter","Rice","Sweets","Lentils","Spices","Curd","Mithai","Gulab Jamun","Fruits","Nuts"]
  },
  "Holi": { 
    bg:"https://thetravelshots.com/wp-content/uploads/2021/03/Holi.jpg",
    items:["Flour","Sugar","Milk","Ghee","Dry Fruits","Curd","Spices","Chickpea Flour","Lentils","Rice","Colors","Coconut","Nuts","Butter","Kesar","Rose Water","Paneer","Fruits","Sweets","Oil","Vegetables","Jaggery","Honey","Chocolate","Almonds"]
  },
  "Dussehra": { 
    bg:"https://png.pngtree.com/thumb_back/fh260/background/20200904/pngtree-orange-indian-bow-and-arrow-dussehra-background-image_397923.jpg",
    items:["Rice","Wheat Flour","Lentils","Vegetables","Milk","Sugar","Ghee","Cardamom","Coconut","Dry Fruits","Spices","Paneer","Butter","Fruits","Oil","Curd","Sweets","Nuts","Herbs","Honey","Jaggery","Chickpeas","Almonds","Cashews","Chocolate","Kesar"]
  },
  "Eid": { 
    bg:"https://images.tv9telugu.com/wp-content/uploads/2025/06/bakrid-2025.jpg",
    items:["Basmati Rice","Mutton","Chicken","Wheat Flour","Dry Fruits","Milk","Sugar","Spices","Ghee","Onions","Fruits","Nuts","Dates","Oil","Yogurt","Paneer","Vegetables","Butter","Herbs","Honey","Jaggery","Chickpeas","Almonds","Cashews","Chocolate","Kesar"]
  },
  "Christmas": { 
    bg:"https://www.owic.in/blog/wp-content/uploads/2020/10/Christmas-Celebration-in-India.jpg",
    items:["Flour","Butter","Sugar","Eggs","Dry Fruits","Nuts","Milk","Yeast","Spices","Chocolate","Cocoa","Cream","Paneer","Cheese","Fruits","Vegetables","Honey","Jaggery","Vanilla","Oil","Rice","Almonds","Cashews","Dates","Coffee","Tea"]
  },
  "Onam": { 
    bg:"https://cdn.shopify.com/s/files/1/0525/5285/9819/files/57_1_1024x1024.jpg?v=1721476641",
    items:["Rice","Coconut","Banana","Vegetables","Tamarind","Jaggery","Spices","Curry Leaves","Coconut Oil","Dry Fruits","Milk","Sugar","Ghee","Paneer","Herbs","Fruits","Butter","Honey","Almonds","Cashews","Dates","Nuts","Lentils","Chickpeas","Chocolate","Sweets"]
  },
  "Pongal": { 
    bg:"https://static.vecteezy.com/system/resources/thumbnails/016/939/611/small_2x/happy-pongal-south-indian-harvest-festival-happy-pongal-celebration-banner-or-poster-design-background-vector.jpg",
    items:["Rice","Jaggery","Milk","Moong Dal","Ghee","Cashews","Raisins","Cardamom","Dry Fruits","Butter","Paneer","Fruits","Vegetables","Honey","Spices","Oil","Almonds","Chocolate","Sugar","Lentils","Coconut","Dates","Tea","Coffee","Sweets"]
  },
  "Ganesh Chaturthi": { 
    bg:"https://assets.thehansindia.com/h-upload/2024/09/14/1480214-ganesh-visarjan.webp",
    items:["Rice Flour","Jaggery","Coconut","Cardamom","Milk","Ghee","Dry Fruits","Butter","Fruits","Vegetables","Honey","Spices","Oil","Almonds","Chocolate","Sugar","Paneer","Lentils","Chickpeas","Tea","Coffee","Sweets","Dates","Nuts","Herbs","Curd"]
  },
  "Janmashtami": { 
    bg:"https://media.easemytrip.com/media/Blog/India/637021709112057483/637021709112057483uUbunF.jpg",
    items:["Milk","Curd","Butter","Honey","Sugar","Flour","Ghee","Dry Fruits","Paneer","Vegetables","Fruits","Rice","Lentils","Chickpeas","Oil","Spices","Nuts","Almonds","Cashews","Chocolate","Sweets","Tea","Coffee","Jaggery","Dates","Herbs"]
  },
  "Durga Puja": { 
    bg:"https://www.shutterstock.com/image-vector/durga-puja-festival-background-template-260nw-1142262230.jpg",
    items:["Rice","Wheat Flour","Vegetables","Milk","Sugar","Spices","Oil","Lentils","Paneer","Ghee","Butter","Dry Fruits","Fruits","Almonds","Cashews","Dates","Sweets","Chickpeas","Tea","Coffee","Honey","Jaggery","Chocolate","Herbs","Curd"]
  },
  "Guru Nanak Jayanti": { 
    bg:"https://www.hindustantimes.com/ht-img/img/2024/11/14/1600x900/9f21ed28-2f46-4cd4-8cee-c47c4edb6639_1731575939079_1731575958003.jpg",
    items:["Wheat Flour","Sugar","Milk","Ghee","Dry Fruits","Rice","Spices","Paneer","Butter","Fruits","Vegetables","Honey","Jaggery","Nuts","Almonds","Chocolate","Dates","Tea","Coffee","Chickpeas","Oil","Lentils","Coconut","Curd","Sweets"]
  },
  "Makar Sankranti": { 
    bg:"https://upload.wikimedia.org/wikipedia/commons/5/53/Photo_of_makar_sankranti_devootees.jpg",
    items:["Sesame Seeds","Jaggery","Rice","Flour","Peanuts","Milk","Sugar","Ghee","Dry Fruits","Fruits","Vegetables","Oil","Paneer","Butter","Honey","Almonds","Cashews","Dates","Chocolate","Tea","Coffee","Coconut","Lentils","Chickpeas","Sweets","Spices"]
  }
};

let currentItem="", currentFestival="";

// Render festival buttons
function renderFestivalButtons(){
  const container=document.getElementById("festivalButtons");
  container.innerHTML=Object.keys(festivalData).map(f=>`
    <button class="btn btn-outline-success festival-btn" onclick="showFestival('${f}')">${f}</button>
  `).join("");
}

// Show festival image + items
function showFestival(festival){
  currentFestival=festival;
  const data=festivalData[festival];
  document.getElementById("festivalBackground").style.backgroundImage=`url('${data.bg}')`;
  const container=document.getElementById("festivalOutput");
  container.innerHTML=data.items.map(item=>`
    <div class="item-card">
      <strong>${item}</strong><br>
      <button class="btn btn-sm btn-success mt-2" onclick="openPopup('${item}')">‚ûï Add</button>
    </div>
  `).join("");
}

// Open modal
function openPopup(item){
  currentItem=item;
  document.getElementById("popupItem").textContent=`Add ${item}`;
  document.getElementById("popupQtyValue").value=1;
  document.getElementById("popupQtyUnit").value="kg";
  document.getElementById("popupPrice").value="";
  document.getElementById("popupDate").value=new Date().toISOString().split('T')[0];
  new bootstrap.Modal(document.getElementById("popupCard")).show();
}

// Add item
async function confirmAdd(){
  const qty=parseFloat(document.getElementById("popupQtyValue").value);
  const unit=document.getElementById("popupQtyUnit").value;
  const price=parseFloat(document.getElementById("popupPrice").value);
  const date=document.getElementById("popupDate").value || new Date().toISOString().split('T')[0];

  if(!qty || !price){ alert("Enter valid quantity & price"); return; }

  const item={name:currentItem, quantity:qty, unit, price, date, source:currentFestival};

  try{
    const res=await fetch(apiUrl,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(item)
    });
    if(!res.ok) throw new Error("Failed");
    renderAddedItems();
    bootstrap.Modal.getInstance(document.getElementById("popupCard")).hide();
  }catch(err){
    console.error(err); alert("Failed to add item");
  }
}

// Render added items
async function renderAddedItems(){
  try{
    const res=await fetch(apiUrl);
    const data=await res.json();
    const items=data.filter(i=>Object.keys(festivalData).includes(i.source));
    const ul=document.getElementById("addedItems");
    if(!items.length){ ul.innerHTML="<li class='list-group-item'>No items added yet.</li>"; return; }
    ul.innerHTML=items.map(i=>`
      <li class="list-group-item">
        <strong>${i.name}</strong><br>
        Quantity: ${i.quantity} ${i.unit}<br>
        Price: ‚Çπ${i.price}<br>
        Festival: ${i.source}<br>
        Date: ${new Date(i.date).toLocaleDateString('en-GB')}
      </li>
    `).join("");
  }catch(err){ console.error(err); }
}

window.addEventListener("load",()=>{
  renderFestivalButtons();
  renderAddedItems();
});
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

